<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Liceo Exploradores de Sue√±os</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --azul-oscuro: #1e3a8a;
            --amarillo: #fbbf24;
            --verde-claro: #10b981;
            --blanco: #ffffff;
            --gris-claro: #f8fafc;
            --gris-medio: #64748b;
        }
        
        * {
            font-family: 'Inter', sans-serif;
        }
        
        .hero-bg {
            background: linear-gradient(135deg, var(--azul-oscuro) 0%, #1e40af 50%, var(--verde-claro) 100%);
            position: relative;
            overflow: hidden;
        }
        
        .hero-bg::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="25" cy="25" r="1" fill="white" opacity="0.1"/><circle cx="75" cy="75" r="1" fill="white" opacity="0.1"/><circle cx="50" cy="10" r="0.5" fill="white" opacity="0.1"/><circle cx="10" cy="60" r="0.5" fill="white" opacity="0.1"/><circle cx="90" cy="40" r="0.5" fill="white" opacity="0.1"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
            pointer-events: none;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--azul-oscuro) 0%, #1e40af 100%);
            color: var(--blanco);
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(30, 58, 138, 0.3);
            border: none;
            cursor: pointer;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(30, 58, 138, 0.4);
            background: linear-gradient(135deg, #1e40af 0%, var(--azul-oscuro) 100%);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, var(--verde-claro) 0%, #059669 100%);
            color: var(--blanco);
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
            border: none;
            cursor: pointer;
        }
        
        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.4);
            background: linear-gradient(135deg, #059669 0%, var(--verde-claro) 100%);
        }
        
        .btn-accent {
            background: linear-gradient(135deg, var(--amarillo) 0%, #f59e0b 100%);
            color: var(--azul-oscuro);
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(251, 191, 36, 0.3);
            border: none;
            cursor: pointer;
        }
        
        .btn-accent:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(251, 191, 36, 0.4);
            background: linear-gradient(135deg, #f59e0b 0%, var(--amarillo) 100%);
        }
        
        .card-elegant {
            background: var(--blanco);
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            transition: all 0.4s ease;
            border: 1px solid rgba(30, 58, 138, 0.1);
            overflow: hidden;
            position: relative;
        }
        
        .card-elegant::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--azul-oscuro) 0%, var(--verde-claro) 50%, var(--amarillo) 100%);
        }
        
        .card-elegant:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }
        
        .section-hidden {
            display: none;
        }
        
        .whatsapp-float {
            position: fixed;
            width: 65px;
            height: 65px;
            bottom: 30px;
            right: 30px;
            background: linear-gradient(135deg, #25d366 0%, #128c7e 100%);
            color: var(--blanco);
            border-radius: 50%;
            text-align: center;
            font-size: 28px;
            box-shadow: 0 8px 25px rgba(37, 211, 102, 0.4);
            z-index: 100;
            display: flex;
            align-items: center;
            justify-content: center;
            text-decoration: none;
            animation: float 3s ease-in-out infinite;
            transition: all 0.3s ease;
        }
        
        .whatsapp-float:hover {
            transform: scale(1.1);
            box-shadow: 0 12px 35px rgba(37, 211, 102, 0.6);
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        .nav-modern {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(30, 58, 138, 0.1);
        }
        
        .nav-btn {
            position: relative;
            padding: 12px 20px;
            border-radius: 10px;
            font-weight: 500;
            transition: all 0.3s ease;
            color: var(--gris-medio);
        }
        
        .nav-btn:hover {
            color: var(--azul-oscuro);
            background: rgba(30, 58, 138, 0.05);
        }
        
        .nav-active {
            color: var(--azul-oscuro) !important;
            background: linear-gradient(135deg, rgba(30, 58, 138, 0.1) 0%, rgba(16, 185, 129, 0.1) 100%);
            font-weight: 600;
        }
        
        .nav-active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 50%;
            transform: translateX(-50%);
            width: 30px;
            height: 3px;
            background: linear-gradient(90deg, var(--azul-oscuro) 0%, var(--verde-claro) 100%);
            border-radius: 2px;
        }
        
        .tab-modern {
            padding: 12px 20px;
            border-radius: 12px;
            font-weight: 500;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            background: var(--gris-claro);
            color: var(--gris-medio);
        }
        
        .tab-active {
            background: linear-gradient(135deg, var(--azul-oscuro) 0%, var(--verde-claro) 100%);
            color: var(--blanco);
            border-color: var(--azul-oscuro);
            box-shadow: 0 4px 15px rgba(30, 58, 138, 0.3);
        }
        
        .input-modern {
            padding: 14px 18px;
            border: 2px solid rgba(30, 58, 138, 0.1);
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: var(--blanco);
            color: var(--azul-oscuro);
        }
        
        .input-modern:focus {
            outline: none;
            border-color: var(--azul-oscuro);
            box-shadow: 0 0 0 3px rgba(30, 58, 138, 0.1);
            transform: translateY(-1px);
        }
        
        .grade-card {
            transition: all 0.4s ease;
            background: var(--blanco);
            border-radius: 16px;
            border: 2px solid rgba(30, 58, 138, 0.1);
            overflow: hidden;
            position: relative;
        }
        
        .grade-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--verde-claro) 0%, var(--amarillo) 100%);
        }
        
        .grade-card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
            border-color: var(--verde-claro);
        }
        
        .logo-gradient {
            background: linear-gradient(135deg, var(--azul-oscuro) 0%, var(--verde-claro) 100%);
        }
        
        .text-gradient {
            background: linear-gradient(135deg, var(--azul-oscuro) 0%, var(--verde-claro) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .modal-modern {
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(10px);
        }
        
        .modal-content {
            background: var(--blanco);
            border-radius: 20px;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(30, 58, 138, 0.1);
        }
        
        .stats-card {
            background: linear-gradient(135deg, var(--blanco) 0%, var(--gris-claro) 100%);
            border-radius: 16px;
            border: 2px solid rgba(30, 58, 138, 0.1);
            transition: all 0.3s ease;
        }
        
        .stats-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .coordinator-badge {
            background: linear-gradient(135deg, var(--amarillo) 0%, #f59e0b 100%);
            color: var(--azul-oscuro);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            display: inline-block;
            margin-top: 8px;
        }
        
        .teacher-card {
            background: var(--blanco);
            border-radius: 16px;
            border: 2px solid rgba(30, 58, 138, 0.1);
            transition: all 0.3s ease;
            overflow: hidden;
            position: relative;
        }
        
        .teacher-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--azul-oscuro) 0%, var(--verde-claro) 50%, var(--amarillo) 100%);
        }
        
        .teacher-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
            border-color: var(--verde-claro);
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- WhatsApp Float Button -->
    <a href="https://wa.me/573001234567" target="_blank" class="whatsapp-float">
        <i class="fab fa-whatsapp"></i>
    </a>

    <!-- Navigation -->
    <nav class="nav-modern shadow-xl sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-6">
            <div class="flex justify-between items-center py-5">
                <div class="flex items-center space-x-4">
                    <div class="w-14 h-14 logo-gradient rounded-2xl flex items-center justify-center shadow-lg">
                        <i class="fas fa-graduation-cap text-white text-2xl"></i>
                    </div>
                    <div>
                        <h1 class="text-2xl font-bold text-gradient">Liceo Exploradores de Sue√±os</h1>
                        <p class="text-sm font-medium" style="color: var(--gris-medio);">17 a√±os formando el futuro</p>
                    </div>
                </div>
                <div class="hidden md:flex space-x-2">
                    <button onclick="showSection('inicio')" class="nav-btn nav-active">
                        <i class="fas fa-home mr-2"></i>Inicio
                    </button>
                    <button onclick="showSection('docentes')" class="nav-btn">
                        <i class="fas fa-chalkboard-teacher mr-2"></i>Docentes
                    </button>
                    <button onclick="showSection('padres')" class="nav-btn">
                        <i class="fas fa-users mr-2"></i>Padres
                    </button>
                    <button onclick="showSection('administrador')" class="nav-btn">
                        <i class="fas fa-cog mr-2"></i>Administrador
                    </button>
                </div>
                <div class="md:hidden">
                    <button onclick="toggleMobileMenu()" class="p-3 rounded-xl" style="color: var(--azul-oscuro);">
                        <i class="fas fa-bars text-xl"></i>
                    </button>
                </div>
            </div>
            <!-- Mobile Menu -->
            <div id="mobileMenu" class="hidden md:hidden pb-4 space-y-2">
                <button onclick="showSection('inicio')" class="nav-btn w-full text-left">
                    <i class="fas fa-home mr-2"></i>Inicio
                </button>
                <button onclick="showSection('docentes')" class="nav-btn w-full text-left">
                    <i class="fas fa-chalkboard-teacher mr-2"></i>Docentes
                </button>
                <button onclick="showSection('padres')" class="nav-btn w-full text-left">
                    <i class="fas fa-users mr-2"></i>Padres
                </button>
                <button onclick="showSection('administrador')" class="nav-btn w-full text-left">
                    <i class="fas fa-cog mr-2"></i>Administrador
                </button>
            </div>
        </div>
    </nav>

    <!-- Inicio Section -->
    <section id="inicio" class="section">
        <!-- Hero Section -->
        <div class="hero-bg text-white py-20">
            <div class="max-w-7xl mx-auto px-4 text-center">
                <h1 class="text-5xl font-bold mb-6">¬°Bienvenidos al Liceo Exploradores de Sue√±os!</h1>
                <p class="text-xl mb-8">17 a√±os formando el futuro de nuestros ni√±os</p>
                <p class="text-lg mb-8">Educaci√≥n de calidad desde Jard√≠n hasta Quinto de Primaria</p>
                <div class="flex flex-col sm:flex-row gap-6 justify-center">
                    <a href="https://wa.me/573001234567" target="_blank" class="btn-secondary flex items-center justify-center text-lg">
                        <i class="fab fa-whatsapp mr-3 text-xl"></i> Contactar por WhatsApp
                    </a>
                    <a href="mailto:exploradores2009@gmail.com" class="btn-accent flex items-center justify-center text-lg">
                        <i class="fas fa-envelope mr-3 text-xl"></i> Enviar Email
                    </a>
                </div>
            </div>
        </div>

        <!-- Information Cards -->
        <div class="max-w-7xl mx-auto px-6 py-20">
            <div class="grid md:grid-cols-3 gap-8">
                <div class="card-elegant p-8">
                    <div class="text-center mb-6">
                        <div class="w-16 h-16 mx-auto mb-4 rounded-2xl flex items-center justify-center" style="background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);">
                            <i class="fas fa-map-marker-alt text-2xl text-white"></i>
                        </div>
                        <h3 class="text-2xl font-bold text-gradient">Nuestra Ubicaci√≥n</h3>
                    </div>
                    <p class="text-center mb-6 text-lg" style="color: var(--gris-medio);">Carrera 13, n√∫mero 8-48<br>Villa Gorgona, Candelaria</p>
                    <div class="text-center">
                        <button onclick="showMap()" class="btn-primary">
                            <i class="fas fa-map mr-2"></i> Ver en Mapa
                        </button>
                    </div>
                </div>

                <div class="card-elegant p-8">
                    <div class="text-center mb-6">
                        <div class="w-16 h-16 mx-auto mb-4 logo-gradient rounded-2xl flex items-center justify-center">
                            <i class="fas fa-users text-2xl text-white"></i>
                        </div>
                        <h3 class="text-2xl font-bold text-gradient">Nuestros Grados</h3>
                    </div>
                    <ul class="space-y-3" style="color: var(--gris-medio);">
                        <li class="flex items-center text-lg">
                            <div class="w-6 h-6 rounded-full mr-3 flex items-center justify-center" style="background: var(--verde-claro);">
                                <i class="fas fa-check text-white text-sm"></i>
                            </div>
                            Jard√≠n
                        </li>
                        <li class="flex items-center text-lg">
                            <div class="w-6 h-6 rounded-full mr-3 flex items-center justify-center" style="background: var(--verde-claro);">
                                <i class="fas fa-check text-white text-sm"></i>
                            </div>
                            Transici√≥n
                        </li>
                        <li class="flex items-center text-lg">
                            <div class="w-6 h-6 rounded-full mr-3 flex items-center justify-center" style="background: var(--verde-claro);">
                                <i class="fas fa-check text-white text-sm"></i>
                            </div>
                            Primero
                        </li>
                        <li class="flex items-center text-lg">
                            <div class="w-6 h-6 rounded-full mr-3 flex items-center justify-center" style="background: var(--verde-claro);">
                                <i class="fas fa-check text-white text-sm"></i>
                            </div>
                            Segundo
                        </li>
                        <li class="flex items-center text-lg">
                            <div class="w-6 h-6 rounded-full mr-3 flex items-center justify-center" style="background: var(--verde-claro);">
                                <i class="fas fa-check text-white text-sm"></i>
                            </div>
                            Tercero
                        </li>
                        <li class="flex items-center text-lg">
                            <div class="w-6 h-6 rounded-full mr-3 flex items-center justify-center" style="background: var(--verde-claro);">
                                <i class="fas fa-check text-white text-sm"></i>
                            </div>
                            Cuarto
                        </li>
                        <li class="flex items-center text-lg">
                            <div class="w-6 h-6 rounded-full mr-3 flex items-center justify-center" style="background: var(--verde-claro);">
                                <i class="fas fa-check text-white text-sm"></i>
                            </div>
                            Quinto
                        </li>
                    </ul>
                </div>

                <div class="card-elegant p-8">
                    <div class="text-center mb-6">
                        <div class="w-16 h-16 mx-auto mb-4 rounded-2xl flex items-center justify-center" style="background: linear-gradient(135deg, var(--amarillo) 0%, #f59e0b 100%);">
                            <i class="fas fa-calendar-alt text-2xl" style="color: var(--azul-oscuro);"></i>
                        </div>
                        <h3 class="text-2xl font-bold text-gradient">Calendario Escolar</h3>
                    </div>
                    <div id="calendar" class="text-sm max-h-48 overflow-y-auto">
                        <!-- Calendar events will be loaded here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Comments Section -->
        <div style="background: var(--gris-claro);" class="py-20">
            <div class="max-w-4xl mx-auto px-6">
                <h2 class="text-4xl font-bold text-center text-gradient mb-12">Comentarios de Padres</h2>
                <div class="card-elegant p-8 mb-8">
                    <h3 class="text-2xl font-semibold mb-6 text-gradient">
                        <i class="fas fa-comment-dots mr-3"></i>Deja tu comentario
                    </h3>
                    <div class="space-y-6">
                        <input type="text" id="parentName" placeholder="Tu nombre" class="input-modern w-full">
                        <textarea id="parentComment" placeholder="Tu comentario sobre el colegio..." rows="4" class="input-modern w-full"></textarea>
                        <button onclick="addComment()" class="btn-primary">
                            <i class="fas fa-paper-plane mr-2"></i> Enviar Comentario
                        </button>
                    </div>
                </div>
                <div id="commentsList" class="space-y-6">
                    <!-- Comments will be loaded here -->
                </div>
            </div>
        </div>

        <!-- Map Modal -->
        <div id="mapModal" class="modal-modern fixed inset-0 z-50 hidden flex items-center justify-center p-4">
            <div class="modal-content p-8 max-w-2xl w-full">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-2xl font-bold text-gradient">
                        <i class="fas fa-map-marker-alt mr-3"></i>Ubicaci√≥n del Colegio
                    </h3>
                    <button onclick="closeMap()" class="p-2 rounded-xl hover:bg-gray-100 transition-colors" style="color: var(--gris-medio);">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                <div class="bg-gradient-to-br from-gray-100 to-gray-200 h-64 rounded-2xl flex items-center justify-center border-2 border-gray-200">
                    <div class="text-center">
                        <div class="w-16 h-16 mx-auto mb-4 rounded-2xl flex items-center justify-center" style="background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);">
                            <i class="fas fa-map-marker-alt text-2xl text-white"></i>
                        </div>
                        <p class="font-bold text-xl mb-2" style="color: var(--azul-oscuro);">Carrera 13, n√∫mero 8-48</p>
                        <p class="text-lg mb-4" style="color: var(--gris-medio);">Villa Gorgona, Candelaria</p>
                        <a href="https://maps.google.com/?q=Carrera+13+8-48+Villa+Gorgona+Candelaria" target="_blank" class="btn-primary">
                            <i class="fas fa-external-link-alt mr-2"></i>Abrir en Google Maps
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Docentes Section -->
    <section id="docentes" class="section section-hidden" style="background: var(--gris-claro);">
        <div class="max-w-6xl mx-auto px-6 py-20">
            <h2 class="text-4xl font-bold text-center text-gradient mb-12">
                <i class="fas fa-chalkboard-teacher mr-4"></i>Portal de Docentes
            </h2>
            
            <div id="docenteLogin" class="card-elegant p-10 max-w-lg mx-auto">
                <div class="text-center mb-8">
                    <div class="w-20 h-20 mx-auto mb-4 logo-gradient rounded-2xl flex items-center justify-center">
                        <i class="fas fa-user-tie text-3xl text-white"></i>
                    </div>
                    <h3 class="text-2xl font-semibold text-gradient">Iniciar Sesi√≥n - Docentes</h3>
                </div>
                <div class="space-y-6">
                    <input type="text" id="docenteId" placeholder="N√∫mero de identificaci√≥n" class="input-modern w-full">
                    <input type="password" id="docentePassword" placeholder="Contrase√±a" class="input-modern w-full">
                    <button onclick="loginDocente()" class="btn-primary w-full text-lg">
                        <i class="fas fa-sign-in-alt mr-2"></i> Ingresar
                    </button>
                </div>

            </div>

            <div id="docentePanel" class="hidden">
                <div class="card-elegant p-8">
                    <div class="flex flex-col md:flex-row md:justify-between md:items-center mb-8 space-y-4 md:space-y-0">
                        <div>
                            <h3 class="text-3xl font-bold text-gradient">Panel de Docente</h3>
                            <p class="text-lg mt-2" style="color: var(--gris-medio);" id="docenteWelcome"></p>
                        </div>
                        <button onclick="logoutDocente()" class="btn-primary bg-red-500 hover:bg-red-600">
                            <i class="fas fa-sign-out-alt mr-2"></i> Cerrar Sesi√≥n
                        </button>
                    </div>

                    <!-- Tabs -->
                    <div class="flex flex-wrap gap-3 mb-8">
                        <button onclick="showDocenteTab('calificaciones')" id="tabCalificaciones" class="tab-modern tab-active">
                            <i class="fas fa-clipboard-list mr-2"></i> Calificaciones
                        </button>
                        <button onclick="showDocenteTab('estudiantes')" id="tabEstudiantes" class="tab-modern">
                            <i class="fas fa-users mr-2"></i> Mis Estudiantes
                        </button>
                        <button onclick="showDocenteTab('reportes')" id="tabReportes" class="tab-modern">
                            <i class="fas fa-chart-bar mr-2"></i> Reportes
                        </button>
                    </div>

                    <!-- Calificaciones Tab -->
                    <div id="docenteCalificaciones" class="docente-tab">
                        <div class="grid md:grid-cols-2 gap-6 mb-8">
                            <div>
                                <label class="block text-sm font-semibold mb-3" style="color: var(--azul-oscuro);">Grado</label>
                                <select id="gradoSelect" onchange="loadEstudiantesByGrado()" class="input-modern w-full">
                                    <option value="">Seleccionar grado</option>
                                    <option value="jardin">Jard√≠n</option>
                                    <option value="transicion">Transici√≥n</option>
                                    <option value="primero">Primero</option>
                                    <option value="segundo">Segundo</option>
                                    <option value="tercero">Tercero</option>
                                    <option value="cuarto">Cuarto</option>
                                    <option value="quinto">Quinto</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold mb-3" style="color: var(--azul-oscuro);">Materia</label>
                                <select id="materiaSelect" class="input-modern w-full">
                                    <option value="">Seleccionar materia</option>
                                    <option value="matematicas">Matem√°ticas</option>
                                    <option value="espanol">Espa√±ol</option>
                                    <option value="ciencias">Ciencias Naturales</option>
                                    <option value="sociales">Ciencias Sociales</option>
                                    <option value="ingles">Ingl√©s</option>
                                    <option value="educacion_fisica">Educaci√≥n F√≠sica</option>
                                    <option value="artes">Artes</option>
                                </select>
                            </div>
                        </div>

                        <div class="space-y-6">
                            <div>
                                <label class="block text-sm font-semibold mb-3" style="color: var(--azul-oscuro);">Estudiante</label>
                                <select id="estudianteSelectDocente" class="input-modern w-full">
                                    <option value="">Seleccionar estudiante</option>
                                </select>
                            </div>
                            <div class="grid md:grid-cols-2 gap-6">
                                <div>
                                    <label class="block text-sm font-semibold mb-3" style="color: var(--azul-oscuro);">Calificaci√≥n (1-5)</label>
                                    <input type="number" id="calificacion" min="1" max="5" step="0.1" class="input-modern w-full">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold mb-3" style="color: var(--azul-oscuro);">Per√≠odo</label>
                                    <select id="periodoSelect" class="input-modern w-full">
                                        <option value="1">Primer Per√≠odo</option>
                                        <option value="2">Segundo Per√≠odo</option>
                                        <option value="3">Tercer Per√≠odo</option>
                                        <option value="4">Cuarto Per√≠odo</option>
                                    </select>
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold mb-3" style="color: var(--azul-oscuro);">Observaciones (opcional)</label>
                                <textarea id="observaciones" placeholder="Escribe observaciones sobre el desempe√±o del estudiante..." rows="4" class="input-modern w-full"></textarea>
                            </div>
                            <button onclick="guardarCalificacion()" class="btn-secondary w-full text-lg">
                                <i class="fas fa-save mr-2"></i> Guardar Calificaci√≥n
                            </button>
                        </div>
                    </div>

                    <!-- Estudiantes Tab -->
                    <div id="docenteEstudiantes" class="docente-tab hidden">
                        <div class="mb-4">
                            <select id="gradoFilterDocente" onchange="filterEstudiantesDocente()" class="p-2 border border-gray-300 rounded-lg">
                                <option value="">Todos los grados</option>
                                <option value="jardin">Jard√≠n</option>
                                <option value="transicion">Transici√≥n</option>
                                <option value="primero">Primero</option>
                                <option value="segundo">Segundo</option>
                                <option value="tercero">Tercero</option>
                                <option value="cuarto">Cuarto</option>
                                <option value="quinto">Quinto</option>
                            </select>
                        </div>
                        <div id="estudiantesListDocente" class="grid md:grid-cols-2 lg:grid-cols-3 gap-4">
                            <!-- Students will be loaded here -->
                        </div>
                    </div>

                    <!-- Reportes Tab -->
                    <div id="docenteReportes" class="docente-tab hidden">
                        <div class="grid md:grid-cols-2 gap-6">
                            <div class="bg-blue-50 p-6 rounded-lg">
                                <h4 class="text-lg font-semibold text-blue-800 mb-4">Estad√≠sticas Generales</h4>
                                <div id="estadisticasDocente">
                                    <!-- Statistics will be loaded here -->
                                </div>
                            </div>
                            <div class="bg-green-50 p-6 rounded-lg">
                                <h4 class="text-lg font-semibold text-green-800 mb-4">Rendimiento por Materia</h4>
                                <div id="rendimientoMaterias">
                                    <!-- Subject performance will be loaded here -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Padres Section -->
    <section id="padres" class="section section-hidden">
        <div class="max-w-4xl mx-auto px-4 py-16">
            <h2 class="text-3xl font-bold text-center text-gray-800 mb-8">Portal de Padres</h2>
            
            <div class="bg-white rounded-lg shadow-lg p-8 mb-8">
                <h3 class="text-xl font-semibold mb-6 text-center">Consultar Informaci√≥n del Estudiante</h3>
                <div class="space-y-4">
                    <input type="text" id="estudianteIdPadres" placeholder="N√∫mero de identificaci√≥n del estudiante" class="w-full p-3 border border-gray-300 rounded-lg">
                    <button onclick="consultarEstudiante()" class="w-full bg-blue-500 hover:bg-blue-600 text-white py-3 rounded-lg font-semibold">
                        <i class="fas fa-search mr-2"></i> Consultar Informaci√≥n
                    </button>
                </div>

            </div>

            <div id="estudianteInfo" class="hidden">
                <!-- Tabs for Parents -->
                <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
                    <div class="flex space-x-2 mb-6">
                        <button onclick="showPadreTab('notas')" id="tabNotas" class="px-4 py-2 rounded-lg tab-active">
                            <i class="fas fa-clipboard-list mr-2"></i> Notas
                        </button>
                        <button onclick="showPadreTab('asistencia')" id="tabAsistencia" class="px-4 py-2 rounded-lg bg-gray-200">
                            <i class="fas fa-calendar-check mr-2"></i> Asistencia
                        </button>
                        <button onclick="showPadreTab('comportamiento')" id="tabComportamiento" class="px-4 py-2 rounded-lg bg-gray-200">
                            <i class="fas fa-star mr-2"></i> Comportamiento
                        </button>
                    </div>

                    <!-- Student Info Header -->
                    <div id="estudianteHeader" class="mb-6 p-4 bg-gray-50 rounded-lg">
                        <!-- Student info will be loaded here -->
                    </div>

                    <!-- Notas Tab -->
                    <div id="padreNotas" class="padre-tab">
                        <div id="notasContent">
                            <!-- Grades will be loaded here -->
                        </div>
                    </div>

                    <!-- Asistencia Tab -->
                    <div id="padreAsistencia" class="padre-tab hidden">
                        <div class="text-center py-8">
                            <i class="fas fa-calendar-check text-4xl text-green-500 mb-4"></i>
                            <h4 class="text-lg font-semibold mb-2">Registro de Asistencia</h4>
                            <p class="text-gray-600">Asistencia: 95% (19/20 d√≠as)</p>
                            <div class="mt-4 grid grid-cols-7 gap-2 max-w-md mx-auto">
                                <div class="text-xs font-semibold text-center py-2">L</div>
                                <div class="text-xs font-semibold text-center py-2">M</div>
                                <div class="text-xs font-semibold text-center py-2">M</div>
                                <div class="text-xs font-semibold text-center py-2">J</div>
                                <div class="text-xs font-semibold text-center py-2">V</div>
                                <div class="text-xs font-semibold text-center py-2">S</div>
                                <div class="text-xs font-semibold text-center py-2">D</div>
                                <!-- Sample attendance grid -->
                                <div class="w-8 h-8 bg-green-500 rounded text-white text-xs flex items-center justify-center">‚úì</div>
                                <div class="w-8 h-8 bg-green-500 rounded text-white text-xs flex items-center justify-center">‚úì</div>
                                <div class="w-8 h-8 bg-green-500 rounded text-white text-xs flex items-center justify-center">‚úì</div>
                                <div class="w-8 h-8 bg-green-500 rounded text-white text-xs flex items-center justify-center">‚úì</div>
                                <div class="w-8 h-8 bg-red-500 rounded text-white text-xs flex items-center justify-center">‚úó</div>
                                <div class="w-8 h-8 bg-gray-300 rounded"></div>
                                <div class="w-8 h-8 bg-gray-300 rounded"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Comportamiento Tab -->
                    <div id="padreComportamiento" class="padre-tab hidden">
                        <div class="space-y-4">
                            <div class="flex items-center justify-between p-4 bg-green-50 rounded-lg">
                                <div>
                                    <h5 class="font-semibold text-green-800">Excelente Comportamiento</h5>
                                    <p class="text-sm text-green-600">Participaci√≥n activa en clase</p>
                                </div>
                                <div class="flex text-yellow-400">
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                </div>
                            </div>
                            <div class="flex items-center justify-between p-4 bg-blue-50 rounded-lg">
                                <div>
                                    <h5 class="font-semibold text-blue-800">Trabajo en Equipo</h5>
                                    <p class="text-sm text-blue-600">Colabora bien con sus compa√±eros</p>
                                </div>
                                <div class="flex text-yellow-400">
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="far fa-star"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Administrador Section -->
    <section id="administrador" class="section section-hidden">
        <div class="max-w-7xl mx-auto px-4 py-16">
            <h2 class="text-3xl font-bold text-center text-gray-800 mb-8">Panel de Administraci√≥n</h2>
            
            <div id="adminLogin" class="bg-white rounded-lg shadow-lg p-8 max-w-md mx-auto">
                <h3 class="text-xl font-semibold mb-6 text-center">Acceso Administrativo</h3>
                <div class="space-y-4">
                    <input type="text" id="adminUser" placeholder="Usuario administrador" class="w-full p-3 border border-gray-300 rounded-lg">
                    <input type="password" id="adminPassword" placeholder="Contrase√±a" class="w-full p-3 border border-gray-300 rounded-lg">
                    <button onclick="loginAdmin()" class="w-full bg-purple-500 hover:bg-purple-600 text-white py-3 rounded-lg font-semibold">
                        <i class="fas fa-key mr-2"></i> Acceder
                    </button>
                </div>

            </div>

            <div id="adminPanel" class="hidden">
                <div class="flex justify-between items-center mb-8">
                    <h3 class="text-2xl font-semibold">Panel de Control Administrativo</h3>
                    <button onclick="logoutAdmin()" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg">
                        <i class="fas fa-sign-out-alt mr-2"></i> Cerrar Sesi√≥n
                    </button>
                </div>

                <!-- Admin Tabs -->
                <div class="flex flex-wrap space-x-2 mb-6">
                    <button onclick="showAdminTab('docentes')" id="adminTabDocentes" class="px-4 py-2 rounded-lg tab-active mb-2">
                        <i class="fas fa-chalkboard-teacher mr-2"></i> Docentes
                    </button>
                    <button onclick="showAdminTab('estudiantes')" id="adminTabEstudiantes" class="px-4 py-2 rounded-lg bg-gray-200 mb-2">
                        <i class="fas fa-user-graduate mr-2"></i> Estudiantes
                    </button>
                    <button onclick="showAdminTab('calendario')" id="adminTabCalendario" class="px-4 py-2 rounded-lg bg-gray-200 mb-2">
                        <i class="fas fa-calendar-alt mr-2"></i> Calendario
                    </button>
                    <button onclick="showAdminTab('reportes')" id="adminTabReportes" class="px-4 py-2 rounded-lg bg-gray-200 mb-2">
                        <i class="fas fa-chart-line mr-2"></i> Reportes
                    </button>
                    <button onclick="showAdminTab('configuracion')" id="adminTabConfiguracion" class="px-4 py-2 rounded-lg bg-gray-200 mb-2">
                        <i class="fas fa-cog mr-2"></i> Configuraci√≥n
                    </button>
                </div>

                <!-- Docentes Tab -->
                <div id="adminDocentes" class="admin-tab">
                    <div class="bg-white rounded-lg shadow-lg p-6">
                        <h4 class="text-lg font-semibold mb-4 text-blue-600">
                            <i class="fas fa-chalkboard-teacher mr-2"></i> Gesti√≥n de Docentes
                        </h4>
                        <div class="grid md:grid-cols-2 gap-6">
                            <div>
                                <h5 class="font-semibold mb-3">Agregar Nuevo Docente</h5>
                                <div class="space-y-4">
                                    <input type="text" id="nuevoDocenteId" placeholder="ID del docente" class="input-modern w-full">
                                    <input type="text" id="nuevoDocenteNombre" placeholder="Nombre completo" class="input-modern w-full">
                                    <input type="email" id="nuevoDocenteEmail" placeholder="Email" class="input-modern w-full">
                                    <input type="password" id="nuevoDocentePassword" placeholder="Contrase√±a" class="input-modern w-full">
                                    <select id="nuevoDocenteMateria" class="input-modern w-full">
                                        <option value="">Materia principal</option>
                                        <option value="matematicas">Matem√°ticas</option>
                                        <option value="espanol">Espa√±ol</option>
                                        <option value="ciencias">Ciencias Naturales</option>
                                        <option value="sociales">Ciencias Sociales</option>
                                        <option value="ingles">Ingl√©s</option>
                                        <option value="educacion_fisica">Educaci√≥n F√≠sica</option>
                                        <option value="artes">Artes</option>
                                    </select>
                                    <select id="nuevoDocenteCoordinador" class="input-modern w-full">
                                        <option value="">Coordinador de grado (opcional)</option>
                                        <option value="jardin">Jard√≠n</option>
                                        <option value="transicion">Transici√≥n</option>
                                        <option value="primero">Primero</option>
                                        <option value="segundo">Segundo</option>
                                        <option value="tercero">Tercero</option>
                                        <option value="cuarto">Cuarto</option>
                                        <option value="quinto">Quinto</option>
                                    </select>
                                    <button onclick="agregarDocente()" class="btn-primary w-full">
                                        <i class="fas fa-plus mr-2"></i> Agregar Docente
                                    </button>
                                </div>
                            </div>
                            <div>
                                <h5 class="font-semibold mb-3">Lista de Docentes</h5>
                                <div id="listaDocentes" class="space-y-2 max-h-64 overflow-y-auto">
                                    <!-- Teachers list will be loaded here -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Estudiantes Tab -->
                <div id="adminEstudiantes" class="admin-tab hidden">
                    <div class="bg-white rounded-lg shadow-lg p-6">
                        <h4 class="text-lg font-semibold mb-4 text-green-600">
                            <i class="fas fa-user-graduate mr-2"></i> Gesti√≥n de Estudiantes
                        </h4>
                        <div class="grid md:grid-cols-2 gap-6">
                            <div>
                                <h5 class="font-semibold mb-3">Agregar Nuevo Estudiante</h5>
                                <div class="space-y-3">
                                    <input type="text" id="nuevoEstudianteId" placeholder="ID del estudiante" class="w-full p-2 border border-gray-300 rounded">
                                    <input type="text" id="nuevoEstudianteNombre" placeholder="Nombre completo" class="w-full p-2 border border-gray-300 rounded">
                                    <input type="date" id="nuevoEstudianteFecha" class="w-full p-2 border border-gray-300 rounded">
                                    <select id="nuevoEstudianteGrado" class="w-full p-2 border border-gray-300 rounded">
                                        <option value="">Seleccionar grado</option>
                                        <option value="jardin">Jard√≠n</option>
                                        <option value="transicion">Transici√≥n</option>
                                        <option value="primero">Primero</option>
                                        <option value="segundo">Segundo</option>
                                        <option value="tercero">Tercero</option>
                                        <option value="cuarto">Cuarto</option>
                                        <option value="quinto">Quinto</option>
                                    </select>
                                    <input type="text" id="nuevoEstudianteAcudiente" placeholder="Nombre del acudiente" class="w-full p-2 border border-gray-300 rounded">
                                    <input type="tel" id="nuevoEstudianteTelefono" placeholder="Tel√©fono del acudiente" class="w-full p-2 border border-gray-300 rounded">
                                    <button onclick="agregarEstudiante()" class="w-full bg-green-500 hover:bg-green-600 text-white py-2 rounded">
                                        <i class="fas fa-plus mr-2"></i> Agregar Estudiante
                                    </button>
                                </div>
                            </div>
                            <div>
                                <h5 class="font-semibold mb-3">Lista de Estudiantes</h5>
                                <div class="mb-3">
                                    <select id="filtroGradoAdmin" onchange="filtrarEstudiantesAdmin()" class="p-2 border border-gray-300 rounded">
                                        <option value="">Todos los grados</option>
                                        <option value="jardin">Jard√≠n</option>
                                        <option value="transicion">Transici√≥n</option>
                                        <option value="primero">Primero</option>
                                        <option value="segundo">Segundo</option>
                                        <option value="tercero">Tercero</option>
                                        <option value="cuarto">Cuarto</option>
                                        <option value="quinto">Quinto</option>
                                    </select>
                                </div>
                                <div id="listaEstudiantes" class="space-y-2 max-h-64 overflow-y-auto">
                                    <!-- Students list will be loaded here -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Calendario Tab -->
                <div id="adminCalendario" class="admin-tab hidden">
                    <div class="bg-white rounded-lg shadow-lg p-6">
                        <h4 class="text-lg font-semibold mb-4 text-purple-600">
                            <i class="fas fa-calendar-alt mr-2"></i> Gesti√≥n de Calendario Escolar
                        </h4>
                        <div class="grid md:grid-cols-2 gap-6">
                            <div>
                                <h5 class="font-semibold mb-3">Agregar Evento</h5>
                                <div class="space-y-3">
                                    <input type="date" id="nuevaFecha" class="w-full p-2 border border-gray-300 rounded">
                                    <input type="text" id="nuevoEvento" placeholder="Descripci√≥n del evento" class="w-full p-2 border border-gray-300 rounded">
                                    <select id="tipoEvento" class="w-full p-2 border border-gray-300 rounded">
                                        <option value="academico">Acad√©mico</option>
                                        <option value="reunion">Reuni√≥n</option>
                                        <option value="festivo">Festivo</option>
                                        <option value="evaluacion">Evaluaci√≥n</option>
                                        <option value="actividad">Actividad Especial</option>
                                    </select>
                                    <textarea id="descripcionEvento" placeholder="Descripci√≥n detallada (opcional)" rows="3" class="w-full p-2 border border-gray-300 rounded"></textarea>
                                    <button onclick="agregarEvento()" class="w-full bg-purple-500 hover:bg-purple-600 text-white py-2 rounded">
                                        <i class="fas fa-plus mr-2"></i> Agregar Evento
                                    </button>
                                </div>
                            </div>
                            <div>
                                <h5 class="font-semibold mb-3">Eventos Programados</h5>
                                <div id="listaEventos" class="space-y-2 max-h-64 overflow-y-auto">
                                    <!-- Events list will be loaded here -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Reportes Tab -->
                <div id="adminReportes" class="admin-tab hidden">
                    <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div class="bg-blue-50 p-6 rounded-lg">
                            <h4 class="text-lg font-semibold text-blue-800 mb-4">Estad√≠sticas Generales</h4>
                            <div id="estadisticasGenerales">
                                <!-- General statistics will be loaded here -->
                            </div>
                        </div>
                        <div class="bg-green-50 p-6 rounded-lg">
                            <h4 class="text-lg font-semibold text-green-800 mb-4">Rendimiento Acad√©mico</h4>
                            <div id="rendimientoAcademico">
                                <!-- Academic performance will be loaded here -->
                            </div>
                        </div>
                        <div class="bg-yellow-50 p-6 rounded-lg">
                            <h4 class="text-lg font-semibold text-yellow-800 mb-4">Asistencia</h4>
                            <div id="reporteAsistencia">
                                <!-- Attendance report will be loaded here -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Configuraci√≥n Tab -->
                <div id="adminConfiguracion" class="admin-tab hidden">
                    <div class="bg-white rounded-lg shadow-lg p-6">
                        <h4 class="text-lg font-semibold mb-4 text-gray-800">
                            <i class="fas fa-cog mr-2"></i> Configuraci√≥n del Sistema
                        </h4>
                        <div class="space-y-6">
                            <div>
                                <h5 class="font-semibold mb-3">Informaci√≥n del Colegio</h5>
                                <div class="grid md:grid-cols-2 gap-4">
                                    <input type="text" id="nombreColegio" value="Liceo Exploradores de Sue√±os" class="w-full p-2 border border-gray-300 rounded">
                                    <input type="text" id="direccionColegio" value="Carrera 13, n√∫mero 8-48, Villa Gorgona, Candelaria" class="w-full p-2 border border-gray-300 rounded">
                                    <input type="tel" id="telefonoColegio" value="3001234567" class="w-full p-2 border border-gray-300 rounded">
                                    <input type="email" id="emailColegio" value="exploradores2009@gmail.com" class="w-full p-2 border border-gray-300 rounded">
                                </div>
                            </div>
                            <div>
                                <h5 class="font-semibold mb-3">Configuraci√≥n Acad√©mica</h5>
                                <div class="grid md:grid-cols-2 gap-4">
                                    <input type="number" id="anoEscolar" value="2024" class="w-full p-2 border border-gray-300 rounded" placeholder="A√±o escolar">
                                    <select id="periodoActual" class="w-full p-2 border border-gray-300 rounded">
                                        <option value="1">Primer Per√≠odo</option>
                                        <option value="2">Segundo Per√≠odo</option>
                                        <option value="3">Tercer Per√≠odo</option>
                                        <option value="4">Cuarto Per√≠odo</option>
                                    </select>
                                </div>
                            </div>
                            <button onclick="guardarConfiguracion()" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-2 rounded-lg">
                                <i class="fas fa-save mr-2"></i> Guardar Configuraci√≥n
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <script>
        // Data Storage with enhanced structure and validation
        let docentes;
        try {
            const storedDocentes = localStorage.getItem('docentes');
            if (storedDocentes) {
                docentes = JSON.parse(storedDocentes);
                if (!Array.isArray(docentes)) {
                    throw new Error('Invalid data format');
                }
                // Validate data structure
                docentes = docentes.filter(d => d && d.id && d.nombre && d.password);
                if (docentes.length === 0) {
                    throw new Error('No valid data found');
                }
            } else {
                throw new Error('No data found');
            }
        } catch (error) {
            console.log('Inicializando datos de docentes por defecto');
            docentes = [
            { 
                id: '12345678', 
                nombre: 'Mar√≠a Garc√≠a', 
                email: 'maria.garcia@exploradores.edu.co',
                password: 'docente123',
                materia: 'matematicas',
                coordinador: 'tercero',
                activo: true
            },
            { 
                id: '87654321', 
                nombre: 'Carlos Rodr√≠guez', 
                email: 'carlos.rodriguez@exploradores.edu.co',
                password: 'docente456',
                materia: 'espanol',
                coordinador: 'jardin',
                activo: true
            },
            { 
                id: '11111111', 
                nombre: 'Ana Mart√≠nez', 
                email: 'ana.martinez@exploradores.edu.co',
                password: 'docente789',
                materia: 'ciencias',
                coordinador: 'transicion',
                activo: true
            },
            { 
                id: '22222222', 
                nombre: 'Luis Fern√°ndez', 
                email: 'luis.fernandez@exploradores.edu.co',
                password: 'docente101',
                materia: 'sociales',
                coordinador: 'primero',
                activo: true
            },
            { 
                id: '33333333', 
                nombre: 'Carmen L√≥pez', 
                email: 'carmen.lopez@exploradores.edu.co',
                password: 'docente202',
                materia: 'ingles',
                coordinador: 'segundo',
                activo: true
            },
            { 
                id: '44444444', 
                nombre: 'Roberto Silva', 
                email: 'roberto.silva@exploradores.edu.co',
                password: 'docente303',
                materia: 'educacion_fisica',
                coordinador: 'cuarto',
                activo: true
            },
            { 
                id: '55555555', 
                nombre: 'Patricia Morales', 
                email: 'patricia.morales@exploradores.edu.co',
                password: 'docente404',
                materia: 'artes',
                coordinador: 'quinto',
                activo: true
            }
        ];
        }

        let estudiantes;
        try {
            const storedEstudiantes = localStorage.getItem('estudiantes');
            if (storedEstudiantes) {
                estudiantes = JSON.parse(storedEstudiantes);
                if (!Array.isArray(estudiantes)) {
                    throw new Error('Invalid data format');
                }
                // Validate data structure
                estudiantes = estudiantes.filter(e => e && e.id && e.nombre && e.grado);
                if (estudiantes.length === 0) {
                    throw new Error('No valid data found');
                }
            } else {
                throw new Error('No data found');
            }
        } catch (error) {
            console.log('Inicializando datos de estudiantes por defecto');
            estudiantes = [
            { 
                id: '98765432', 
                nombre: 'Juan P√©rez', 
                grado: 'tercero',
                fechaNacimiento: '2015-03-15',
                acudiente: 'Ana P√©rez',
                telefono: '3001234567',
                activo: true
            },
            { 
                id: '11223344', 
                nombre: 'Ana L√≥pez', 
                grado: 'segundo',
                fechaNacimiento: '2016-07-22',
                acudiente: 'Luis L√≥pez',
                telefono: '3007654321',
                activo: true
            },
            { 
                id: '55667788', 
                nombre: 'Sofia Mart√≠nez', 
                grado: 'tercero',
                fechaNacimiento: '2015-11-08',
                acudiente: 'Carmen Mart√≠nez',
                telefono: '3009876543',
                activo: true
            }
        ];
        }

        let calificaciones;
        try {
            calificaciones = JSON.parse(localStorage.getItem('calificaciones') || '{}');
            if (typeof calificaciones !== 'object' || Object.keys(calificaciones).length === 0) {
                throw new Error('No data found');
            }
        } catch (error) {
            calificaciones = {
            '98765432': {
                nombre: 'Juan P√©rez',
                grado: 'tercero',
                materias: {
                    'matematicas': {
                        '1': { nota: 4.2, observaciones: 'Excelente progreso', docente: 'Mar√≠a Garc√≠a', fecha: '2024-02-15' },
                        '2': { nota: 3.8, observaciones: 'Debe practicar m√°s', docente: 'Mar√≠a Garc√≠a', fecha: '2024-04-20' }
                    },
                    'espanol': {
                        '1': { nota: 4.5, observaciones: 'Muy buena comprensi√≥n lectora', docente: 'Carlos Rodr√≠guez', fecha: '2024-02-18' }
                    }
                }
            },
            '11223344': {
                nombre: 'Ana L√≥pez',
                grado: 'segundo',
                materias: {
                    'matematicas': {
                        '1': { nota: 3.9, observaciones: 'Buen desempe√±o', docente: 'Mar√≠a Garc√≠a', fecha: '2024-02-16' }
                    }
                }
            }
        };
        }

        let comentarios;
        try {
            comentarios = JSON.parse(localStorage.getItem('comentarios') || '[]');
            if (!Array.isArray(comentarios)) {
                throw new Error('Invalid data format');
            }
        } catch (error) {
            comentarios = [
            {
                id: 1,
                name: 'Mar√≠a Gonz√°lez',
                comment: 'Excelente colegio, mis hijos han aprendido mucho en estos a√±os. Los profesores son muy dedicados.',
                date: '2024-01-15'
            }
        ];
        }

        let eventos;
        try {
            eventos = JSON.parse(localStorage.getItem('eventos') || '[]');
            if (!Array.isArray(eventos)) {
                throw new Error('Invalid data format');
            }
        } catch (error) {
            eventos = [
            { 
                fecha: '2024-01-15', 
                evento: 'Inicio de clases',
                tipo: 'academico',
                descripcion: 'Inicio del a√±o escolar 2024'
            },
            { 
                fecha: '2024-02-20', 
                evento: 'Reuni√≥n de padres',
                tipo: 'reunion',
                descripcion: 'Primera reuni√≥n de padres del a√±o'
            },
            { 
                fecha: '2024-03-15', 
                evento: 'Semana de receso',
                tipo: 'festivo',
                descripcion: 'Semana de descanso estudiantil'
            }
        ];
        }

        // Current user session
        let currentUser = null;
        let userType = null;

        // Navigation Functions
        function showSection(sectionName) {
            // Hide all sections
            document.querySelectorAll('.section').forEach(section => {
                section.classList.add('section-hidden');
            });
            
            // Show selected section
            document.getElementById(sectionName).classList.remove('section-hidden');
            
            // Update nav buttons
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('nav-active');
            });
            
            // Add active class to current button
            document.querySelectorAll('.nav-btn').forEach(btn => {
                const btnText = btn.textContent.toLowerCase();
                if ((sectionName === 'inicio' && btnText.includes('inicio')) ||
                    (sectionName === 'docentes' && btnText.includes('docentes')) ||
                    (sectionName === 'padres' && btnText.includes('padres')) ||
                    (sectionName === 'administrador' && btnText.includes('administrador'))) {
                    btn.classList.add('nav-active');
                }
            });
            
            // Hide mobile menu
            const mobileMenu = document.getElementById('mobileMenu');
            if (mobileMenu) {
                mobileMenu.classList.add('hidden');
            }
        }

        function toggleMobileMenu() {
            document.getElementById('mobileMenu').classList.toggle('hidden');
        }

        // Map Functions
        function showMap() {
            document.getElementById('mapModal').classList.remove('hidden');
        }

        function closeMap() {
            document.getElementById('mapModal').classList.add('hidden');
        }

        // Comments Functions
        function addComment() {
            try {
                const nameInput = document.getElementById('parentName');
                const commentInput = document.getElementById('parentComment');
                
                if (!nameInput || !commentInput) {
                    alert('Error: Campos no encontrados.');
                    return;
                }
                
                const name = nameInput.value.trim();
                const comment = commentInput.value.trim();
                
                if (!name || !comment) {
                    alert('Por favor completa todos los campos.');
                    return;
                }
                
                const newComment = {
                    id: Date.now(),
                    name: name,
                    comment: comment,
                    date: new Date().toLocaleDateString('es-ES')
                };
                
                comentarios.unshift(newComment);
                localStorage.setItem('comentarios', JSON.stringify(comentarios));
                
                nameInput.value = '';
                commentInput.value = '';
                
                displayComments();
                alert('¬°Comentario agregado exitosamente!');
            } catch (error) {
                console.error('Error agregando comentario:', error);
                alert('Error al agregar el comentario. Intenta nuevamente.');
            }
        }

        function displayComments() {
            const commentsList = document.getElementById('commentsList');
            commentsList.innerHTML = '';
            
            comentarios.forEach(comment => {
                const commentDiv = document.createElement('div');
                commentDiv.className = 'card-elegant p-6';
                commentDiv.innerHTML = `
                    <div class="flex items-center mb-4">
                        <div class="w-12 h-12 rounded-2xl flex items-center justify-center mr-4" style="background: var(--amarillo);">
                            <i class="fas fa-user-circle text-2xl" style="color: var(--azul-oscuro);"></i>
                        </div>
                        <div class="flex-1">
                            <strong class="text-lg" style="color: var(--azul-oscuro);">${comment.name}</strong>
                            <span class="text-sm ml-4 px-3 py-1 rounded-full" style="background: var(--gris-claro); color: var(--gris-medio);">${comment.date}</span>
                        </div>
                    </div>
                    <p class="text-lg leading-relaxed" style="color: var(--gris-medio);">${comment.comment}</p>
                `;
                commentsList.appendChild(commentDiv);
            });
        }

        // Docentes Functions
        function loginDocente() {
            const id = document.getElementById('docenteId').value.trim();
            const password = document.getElementById('docentePassword').value.trim();
            
            const docente = docentes.find(d => d.id === id && d.password === password && d.activo);
            
            if (docente) {
                currentUser = docente;
                userType = 'docente';
                document.getElementById('docenteLogin').classList.add('hidden');
                document.getElementById('docentePanel').classList.remove('hidden');
                document.getElementById('docenteWelcome').textContent = `Bienvenido/a, ${docente.nombre}`;
                loadDocenteData();
                alert(`¬°Bienvenido/a, ${docente.nombre}!`);
            } else {
                alert('N√∫mero de identificaci√≥n o contrase√±a incorrectos. Verifique sus datos e intente nuevamente.');
            }
        }

        function logoutDocente() {
            currentUser = null;
            userType = null;
            document.getElementById('docenteLogin').classList.remove('hidden');
            document.getElementById('docentePanel').classList.add('hidden');
            document.getElementById('docenteId').value = '';
            document.getElementById('docentePassword').value = '';
        }

        function showDocenteTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.docente-tab').forEach(tab => {
                tab.classList.add('hidden');
            });
            
            // Show selected tab
            const targetTab = document.getElementById('docente' + tabName.charAt(0).toUpperCase() + tabName.slice(1));
            if (targetTab) {
                targetTab.classList.remove('hidden');
            }
            
            // Update tab buttons - specifically for docente tabs
            const docenteTabButtons = ['tabCalificaciones', 'tabEstudiantes', 'tabReportes'];
            docenteTabButtons.forEach(btnId => {
                const btn = document.getElementById(btnId);
                if (btn) {
                    btn.classList.remove('tab-active');
                    btn.classList.add('tab-modern');
                }
            });
            
            const activeButton = document.getElementById('tab' + tabName.charAt(0).toUpperCase() + tabName.slice(1));
            if (activeButton) {
                activeButton.classList.add('tab-active');
                activeButton.classList.remove('tab-modern');
            }
            
            if (tabName === 'estudiantes') {
                loadEstudiantesDocente();
            } else if (tabName === 'reportes') {
                loadReportesDocente();
            }
        }

        function loadDocenteData() {
            loadEstudiantesDocente();
            loadReportesDocente();
        }

        function loadEstudiantesByGrado() {
            try {
                const gradoSelect = document.getElementById('gradoSelect');
                const estudianteSelect = document.getElementById('estudianteSelectDocente');
                
                if (!gradoSelect || !estudianteSelect) {
                    console.error('Elementos no encontrados');
                    return;
                }
                
                const grado = gradoSelect.value;
                estudianteSelect.innerHTML = '<option value="">Seleccionar estudiante</option>';
                
                if (grado) {
                    const estudiantesGrado = estudiantes.filter(e => e.grado === grado && e.activo);
                    estudiantesGrado.forEach(estudiante => {
                        const option = document.createElement('option');
                        option.value = estudiante.id;
                        option.textContent = `${estudiante.nombre} (${estudiante.id})`;
                        estudianteSelect.appendChild(option);
                    });
                }
            } catch (error) {
                console.error('Error cargando estudiantes por grado:', error);
            }
        }

        function guardarCalificacion() {
            try {
                const grado = document.getElementById('gradoSelect')?.value;
                const materia = document.getElementById('materiaSelect')?.value;
                const estudianteId = document.getElementById('estudianteSelectDocente')?.value;
                const calificacionInput = document.getElementById('calificacion')?.value;
                const periodo = document.getElementById('periodoSelect')?.value;
                const observaciones = document.getElementById('observaciones')?.value?.trim() || '';
                
                if (!grado || !materia || !estudianteId || !calificacionInput || !periodo) {
                    alert('Por favor completa todos los campos obligatorios.');
                    return;
                }
                
                const calificacion = parseFloat(calificacionInput);
                
                if (isNaN(calificacion) || calificacion < 1 || calificacion > 5) {
                    alert('La calificaci√≥n debe ser un n√∫mero entre 1 y 5.');
                    return;
                }
                
                const estudiante = estudiantes.find(e => e.id === estudianteId);
                
                if (!estudiante) {
                    alert('Estudiante no encontrado.');
                    return;
                }
                
                if (!calificaciones[estudianteId]) {
                    calificaciones[estudianteId] = {
                        nombre: estudiante.nombre,
                        grado: estudiante.grado,
                        materias: {}
                    };
                }
                
                if (!calificaciones[estudianteId].materias[materia]) {
                    calificaciones[estudianteId].materias[materia] = {};
                }
                
                calificaciones[estudianteId].materias[materia][periodo] = {
                    nota: calificacion,
                    observaciones: observaciones,
                    docente: currentUser?.nombre || 'Docente',
                    fecha: new Date().toLocaleDateString('es-ES')
                };
                
                localStorage.setItem('calificaciones', JSON.stringify(calificaciones));
                
                // Clear form
                document.getElementById('gradoSelect').value = '';
                document.getElementById('materiaSelect').value = '';
                document.getElementById('estudianteSelectDocente').innerHTML = '<option value="">Seleccionar estudiante</option>';
                document.getElementById('calificacion').value = '';
                document.getElementById('observaciones').value = '';
                
                alert('¬°Calificaci√≥n guardada exitosamente!');
            } catch (error) {
                console.error('Error guardando calificaci√≥n:', error);
                alert('Error al guardar la calificaci√≥n. Intenta nuevamente.');
            }
        }

        function loadEstudiantesDocente() {
            const container = document.getElementById('estudiantesListDocente');
            container.innerHTML = '';
            
            estudiantes.filter(e => e.activo).forEach(estudiante => {
                const card = document.createElement('div');
                card.className = 'teacher-card p-6';
                card.innerHTML = `
                    <div class="flex items-center mb-4">
                        <div class="w-12 h-12 rounded-2xl flex items-center justify-center mr-4" style="background: var(--verde-claro);">
                            <i class="fas fa-user-graduate text-xl text-white"></i>
                        </div>
                        <div>
                            <h5 class="font-bold text-lg" style="color: var(--azul-oscuro);">${estudiante.nombre}</h5>
                            <p class="text-sm font-medium" style="color: var(--gris-medio);">Grado: ${estudiante.grado.charAt(0).toUpperCase() + estudiante.grado.slice(1)}</p>
                            <p class="text-sm" style="color: var(--gris-medio);">ID: ${estudiante.id}</p>
                        </div>
                    </div>
                    <div class="space-y-2" style="color: var(--gris-medio);">
                        <p class="flex items-center">
                            <i class="fas fa-user-friends mr-2" style="color: var(--verde-claro);"></i>
                            Acudiente: ${estudiante.acudiente}
                        </p>
                        <p class="flex items-center">
                            <i class="fas fa-phone mr-2" style="color: var(--amarillo);"></i>
                            Tel√©fono: ${estudiante.telefono}
                        </p>
                    </div>
                `;
                container.appendChild(card);
            });
        }

        function filterEstudiantesDocente() {
            const grado = document.getElementById('gradoFilterDocente').value;
            const container = document.getElementById('estudiantesListDocente');
            container.innerHTML = '';
            
            const estudiantesFiltrados = grado ? 
                estudiantes.filter(e => e.grado === grado && e.activo) : 
                estudiantes.filter(e => e.activo);
            
            estudiantesFiltrados.forEach(estudiante => {
                const card = document.createElement('div');
                card.className = 'bg-white border border-gray-200 rounded-lg p-4 grade-card';
                card.innerHTML = `
                    <div class="flex items-center mb-2">
                        <i class="fas fa-user-graduate text-2xl text-blue-500 mr-3"></i>
                        <div>
                            <h5 class="font-semibold">${estudiante.nombre}</h5>
                            <p class="text-sm text-gray-600">Grado: ${estudiante.grado.charAt(0).toUpperCase() + estudiante.grado.slice(1)}</p>
                            <p class="text-sm text-gray-600">ID: ${estudiante.id}</p>
                        </div>
                    </div>
                    <div class="text-sm text-gray-500">
                        <p>Acudiente: ${estudiante.acudiente}</p>
                        <p>Tel√©fono: ${estudiante.telefono}</p>
                    </div>
                `;
                container.appendChild(card);
            });
        }

        function loadReportesDocente() {
            const estadisticas = document.getElementById('estadisticasDocente');
            const rendimiento = document.getElementById('rendimientoMaterias');
            
            // Calculate statistics
            let totalEstudiantes = estudiantes.filter(e => e.activo).length;
            let totalCalificaciones = 0;
            let sumaNotas = 0;
            
            Object.values(calificaciones).forEach(estudiante => {
                Object.values(estudiante.materias).forEach(materia => {
                    Object.values(materia).forEach(periodo => {
                        if (periodo.docente === currentUser.nombre) {
                            totalCalificaciones++;
                            sumaNotas += periodo.nota;
                        }
                    });
                });
            });
            
            const promedio = totalCalificaciones > 0 ? (sumaNotas / totalCalificaciones).toFixed(2) : 0;
            
            estadisticas.innerHTML = `
                <div class="space-y-2">
                    <p><strong>Total Estudiantes:</strong> ${totalEstudiantes}</p>
                    <p><strong>Calificaciones Registradas:</strong> ${totalCalificaciones}</p>
                    <p><strong>Promedio General:</strong> ${promedio}</p>
                </div>
            `;
            
            // Subject performance
            const materias = ['matematicas', 'espanol', 'ciencias', 'sociales', 'ingles', 'educacion_fisica', 'artes'];
            let rendimientoHTML = '';
            
            materias.forEach(materia => {
                let totalMateria = 0;
                let sumaMateria = 0;
                
                Object.values(calificaciones).forEach(estudiante => {
                    if (estudiante.materias[materia]) {
                        Object.values(estudiante.materias[materia]).forEach(periodo => {
                            if (periodo.docente === currentUser.nombre) {
                                totalMateria++;
                                sumaMateria += periodo.nota;
                            }
                        });
                    }
                });
                
                if (totalMateria > 0) {
                    const promedioMateria = (sumaMateria / totalMateria).toFixed(2);
                    rendimientoHTML += `
                        <div class="flex justify-between items-center py-2 border-b">
                            <span>${materia.charAt(0).toUpperCase() + materia.slice(1)}</span>
                            <span class="font-semibold">${promedioMateria}</span>
                        </div>
                    `;
                }
            });
            
            rendimiento.innerHTML = rendimientoHTML || '<p class="text-gray-500">No hay datos disponibles</p>';
        }

        // Padres Functions
        function consultarEstudiante() {
            const estudianteId = document.getElementById('estudianteIdPadres').value.trim();
            
            if (!estudianteId) {
                alert('Por favor ingresa el n√∫mero de identificaci√≥n del estudiante.');
                return;
            }
            
            const estudiante = estudiantes.find(e => e.id === estudianteId && e.activo);
            
            if (!estudiante) {
                alert('N√∫mero de identificaci√≥n incorrecto. Verifique el n√∫mero e intente nuevamente.');
                return;
            }
            
            // Show student info
            document.getElementById('estudianteHeader').innerHTML = `
                <div class="flex items-center">
                    <i class="fas fa-user-graduate text-3xl text-blue-500 mr-4"></i>
                    <div>
                        <h4 class="text-xl font-semibold text-gray-800">${estudiante.nombre}</h4>
                        <p class="text-gray-600">Grado: ${estudiante.grado.charAt(0).toUpperCase() + estudiante.grado.slice(1)}</p>
                        <p class="text-gray-600">ID: ${estudiante.id}</p>
                        <p class="text-gray-600">Acudiente: ${estudiante.acudiente}</p>
                    </div>
                </div>
            `;
            
            // Load grades
            loadNotasEstudiante(estudianteId);
            
            document.getElementById('estudianteInfo').classList.remove('hidden');
        }

        function showPadreTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.padre-tab').forEach(tab => {
                tab.classList.add('hidden');
            });
            
            // Show selected tab
            const targetTab = document.getElementById('padre' + tabName.charAt(0).toUpperCase() + tabName.slice(1));
            if (targetTab) {
                targetTab.classList.remove('hidden');
            }
            
            // Update tab buttons - only for padre tabs
            const padreTabButtons = ['tabNotas', 'tabAsistencia', 'tabComportamiento'];
            padreTabButtons.forEach(btnId => {
                const btn = document.getElementById(btnId);
                if (btn) {
                    btn.classList.remove('tab-active');
                    btn.classList.add('bg-gray-200');
                }
            });
            
            const activeButton = document.getElementById('tab' + tabName.charAt(0).toUpperCase() + tabName.slice(1));
            if (activeButton) {
                activeButton.classList.add('tab-active');
                activeButton.classList.remove('bg-gray-200');
            }
        }

        function loadNotasEstudiante(estudianteId) {
            const notasEstudiante = calificaciones[estudianteId];
            const notasContent = document.getElementById('notasContent');
            
            if (!notasEstudiante || !notasEstudiante.materias) {
                notasContent.innerHTML = '<p class="text-gray-500 text-center py-8">No hay calificaciones registradas para este estudiante.</p>';
                return;
            }
            
            let notasHTML = '';
            
            Object.entries(notasEstudiante.materias).forEach(([materia, periodos]) => {
                notasHTML += `
                    <div class="border border-gray-200 rounded-lg p-4 mb-4">
                        <h5 class="font-semibold text-gray-800 mb-3 text-lg">${materia.charAt(0).toUpperCase() + materia.slice(1)}</h5>
                        <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-3">
                `;
                
                for (let i = 1; i <= 4; i++) {
                    const periodo = periodos[i.toString()];
                    if (periodo) {
                        const colorClass = periodo.nota >= 3.5 ? 'bg-green-50 border-green-200' : 
                                         periodo.nota >= 3.0 ? 'bg-yellow-50 border-yellow-200' : 
                                         'bg-red-50 border-red-200';
                        const textColor = periodo.nota >= 3.5 ? 'text-green-800' : 
                                        periodo.nota >= 3.0 ? 'text-yellow-800' : 
                                        'text-red-800';
                        
                        notasHTML += `
                            <div class="border rounded p-3 ${colorClass}">
                                <div class="text-center">
                                    <p class="text-sm font-medium text-gray-600">Per√≠odo ${i}</p>
                                    <p class="text-2xl font-bold ${textColor}">${periodo.nota}</p>
                                </div>
                                ${periodo.observaciones ? `<p class="text-xs text-gray-600 mt-2">${periodo.observaciones}</p>` : ''}
                                <p class="text-xs text-gray-500 mt-1">Prof. ${periodo.docente}</p>
                                <p class="text-xs text-gray-500">${periodo.fecha}</p>
                            </div>
                        `;
                    } else {
                        notasHTML += `
                            <div class="border border-gray-200 rounded p-3 bg-gray-50">
                                <div class="text-center">
                                    <p class="text-sm font-medium text-gray-600">Per√≠odo ${i}</p>
                                    <p class="text-lg text-gray-400">-</p>
                                </div>
                                <p class="text-xs text-gray-400 text-center mt-2">Sin calificar</p>
                            </div>
                        `;
                    }
                }
                
                notasHTML += '</div></div>';
            });
            
            notasContent.innerHTML = notasHTML;
        }

        // Admin Functions
        function loginAdmin() {
            const user = document.getElementById('adminUser').value.trim();
            const password = document.getElementById('adminPassword').value.trim();
            
            if (user === 'admin' && password === 'admin123') {
                currentUser = { nombre: 'Administrador' };
                userType = 'admin';
                document.getElementById('adminLogin').classList.add('hidden');
                document.getElementById('adminPanel').classList.remove('hidden');
                loadAdminData();
                alert('¬°Bienvenido, Administrador!');
            } else {
                alert('Credenciales incorrectas.');
            }
        }

        function logoutAdmin() {
            currentUser = null;
            userType = null;
            document.getElementById('adminLogin').classList.remove('hidden');
            document.getElementById('adminPanel').classList.add('hidden');
            document.getElementById('adminUser').value = '';
            document.getElementById('adminPassword').value = '';
        }

        function showAdminTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.admin-tab').forEach(tab => {
                tab.classList.add('hidden');
            });
            
            // Show selected tab
            const targetTab = document.getElementById('admin' + tabName.charAt(0).toUpperCase() + tabName.slice(1));
            if (targetTab) {
                targetTab.classList.remove('hidden');
            }
            
            // Update tab buttons - only admin tabs
            const adminTabButtons = ['adminTabDocentes', 'adminTabEstudiantes', 'adminTabCalendario', 'adminTabReportes', 'adminTabConfiguracion'];
            adminTabButtons.forEach(btnId => {
                const btn = document.getElementById(btnId);
                if (btn) {
                    btn.classList.remove('tab-active');
                    btn.classList.add('bg-gray-200');
                }
            });
            
            const activeButton = document.getElementById('adminTab' + tabName.charAt(0).toUpperCase() + tabName.slice(1));
            if (activeButton) {
                activeButton.classList.add('tab-active');
                activeButton.classList.remove('bg-gray-200');
            }
            
            if (tabName === 'reportes') {
                loadReportesAdmin();
            }
        }

        function loadAdminData() {
            displayDocentes();
            displayEstudiantes();
            displayEventos();
            loadReportesAdmin();
        }

        function agregarDocente() {
            const id = document.getElementById('nuevoDocenteId').value.trim();
            const nombre = document.getElementById('nuevoDocenteNombre').value.trim();
            const email = document.getElementById('nuevoDocenteEmail').value.trim();
            const password = document.getElementById('nuevoDocentePassword').value.trim();
            const materia = document.getElementById('nuevoDocenteMateria').value;
            const coordinador = document.getElementById('nuevoDocenteCoordinador').value;
            
            if (!id || !nombre || !email || !password || !materia) {
                alert('Por favor completa todos los campos obligatorios.');
                return;
            }
            
            if (docentes.find(d => d.id === id)) {
                alert('Ya existe un docente con este ID.');
                return;
            }
            
            // Check if coordinator position is already taken
            if (coordinador && docentes.find(d => d.coordinador === coordinador && d.activo)) {
                alert(`Ya existe un coordinador para el grado ${coordinador}. Por favor selecciona otro grado o deja vac√≠o.`);
                return;
            }
            
            docentes.push({ 
                id, 
                nombre, 
                email, 
                password, 
                materia,
                coordinador: coordinador || null,
                activo: true 
            });
            localStorage.setItem('docentes', JSON.stringify(docentes));
            
            // Clear form
            document.getElementById('nuevoDocenteId').value = '';
            document.getElementById('nuevoDocenteNombre').value = '';
            document.getElementById('nuevoDocenteEmail').value = '';
            document.getElementById('nuevoDocentePassword').value = '';
            document.getElementById('nuevoDocenteMateria').value = '';
            document.getElementById('nuevoDocenteCoordinador').value = '';
            
            displayDocentes();
            alert('¬°Docente agregado exitosamente!');
        }

        function displayDocentes() {
            const lista = document.getElementById('listaDocentes');
            lista.innerHTML = '';
            
            docentes.filter(d => d.activo).forEach(docente => {
                const div = document.createElement('div');
                div.className = 'teacher-card p-4 mb-4';
                div.innerHTML = `
                    <div class="flex justify-between items-start">
                        <div class="flex items-center">
                            <div class="w-12 h-12 rounded-2xl flex items-center justify-center mr-4 logo-gradient">
                                <i class="fas fa-chalkboard-teacher text-white"></i>
                            </div>
                            <div>
                                <p class="font-bold text-lg" style="color: var(--azul-oscuro);">${docente.nombre}</p>
                                <p class="text-sm font-medium" style="color: var(--gris-medio);">ID: ${docente.id} | ${docente.materia.charAt(0).toUpperCase() + docente.materia.slice(1)}</p>
                                <p class="text-sm" style="color: var(--gris-medio);">${docente.email}</p>
                                ${docente.coordinador ? `<span class="coordinator-badge">Coordinador ${docente.coordinador.charAt(0).toUpperCase() + docente.coordinador.slice(1)}</span>` : ''}
                            </div>
                        </div>
                        <div class="flex space-x-2">
                            <button onclick="editarDocente('${docente.id}')" class="p-2 rounded-lg hover:bg-blue-100 transition-colors" style="color: var(--azul-oscuro);">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button onclick="eliminarDocente('${docente.id}')" class="p-2 rounded-lg hover:bg-red-100 transition-colors text-red-500">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `;
                lista.appendChild(div);
            });
        }

        function eliminarDocente(id) {
            if (confirm('¬øEst√°s seguro de eliminar este docente?')) {
                const docente = docentes.find(d => d.id === id);
                if (docente) {
                    docente.activo = false;
                    localStorage.setItem('docentes', JSON.stringify(docentes));
                    displayDocentes();
                    alert('Docente eliminado exitosamente.');
                }
            }
        }

        function agregarEstudiante() {
            const id = document.getElementById('nuevoEstudianteId').value.trim();
            const nombre = document.getElementById('nuevoEstudianteNombre').value.trim();
            const fechaNacimiento = document.getElementById('nuevoEstudianteFecha').value;
            const grado = document.getElementById('nuevoEstudianteGrado').value;
            const acudiente = document.getElementById('nuevoEstudianteAcudiente').value.trim();
            const telefono = document.getElementById('nuevoEstudianteTelefono').value.trim();
            
            if (!id || !nombre || !fechaNacimiento || !grado || !acudiente || !telefono) {
                alert('Por favor completa todos los campos.');
                return;
            }
            
            if (estudiantes.find(e => e.id === id)) {
                alert('Ya existe un estudiante con este ID.');
                return;
            }
            
            estudiantes.push({ 
                id, 
                nombre, 
                fechaNacimiento, 
                grado, 
                acudiente, 
                telefono, 
                activo: true 
            });
            localStorage.setItem('estudiantes', JSON.stringify(estudiantes));
            
            // Clear form
            document.getElementById('nuevoEstudianteId').value = '';
            document.getElementById('nuevoEstudianteNombre').value = '';
            document.getElementById('nuevoEstudianteFecha').value = '';
            document.getElementById('nuevoEstudianteGrado').value = '';
            document.getElementById('nuevoEstudianteAcudiente').value = '';
            document.getElementById('nuevoEstudianteTelefono').value = '';
            
            displayEstudiantes();
            alert('¬°Estudiante agregado exitosamente!');
        }

        function displayEstudiantes() {
            const lista = document.getElementById('listaEstudiantes');
            lista.innerHTML = '';
            
            const estudiantesActivos = estudiantes.filter(e => e.activo);
            const filtroGrado = document.getElementById('filtroGradoAdmin')?.value || '';
            
            const estudiantesFiltrados = filtroGrado ? 
                estudiantesActivos.filter(e => e.grado === filtroGrado) : 
                estudiantesActivos;
            
            estudiantesFiltrados.forEach(estudiante => {
                const div = document.createElement('div');
                div.className = 'flex justify-between items-center p-3 bg-gray-50 rounded border';
                div.innerHTML = `
                    <div>
                        <p class="font-semibold">${estudiante.nombre}</p>
                        <p class="text-sm text-gray-600">ID: ${estudiante.id} | Grado: ${estudiante.grado}</p>
                        <p class="text-sm text-gray-600">Acudiente: ${estudiante.acudiente} | Tel: ${estudiante.telefono}</p>
                    </div>
                    <div class="flex space-x-2">
                        <button onclick="editarEstudiante('${estudiante.id}')" class="text-blue-500 hover:text-blue-700">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button onclick="eliminarEstudiante('${estudiante.id}')" class="text-red-500 hover:text-red-700">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                lista.appendChild(div);
            });
        }

        function filtrarEstudiantesAdmin() {
            displayEstudiantes();
        }

        function eliminarEstudiante(id) {
            if (confirm('¬øEst√°s seguro de eliminar este estudiante?')) {
                const estudiante = estudiantes.find(e => e.id === id);
                if (estudiante) {
                    estudiante.activo = false;
                    localStorage.setItem('estudiantes', JSON.stringify(estudiantes));
                    displayEstudiantes();
                    alert('Estudiante eliminado exitosamente.');
                }
            }
        }

        function editarDocente(id) {
            try {
                const docente = docentes.find(d => d.id === id);
                if (!docente) {
                    alert('Docente no encontrado.');
                    return;
                }
                
                const nuevoNombre = prompt('Nuevo nombre:', docente.nombre);
                if (nuevoNombre && nuevoNombre.trim()) {
                    docente.nombre = nuevoNombre.trim();
                    
                    // Update in calificaciones if exists
                    Object.keys(calificaciones).forEach(estudianteId => {
                        const estudiante = calificaciones[estudianteId];
                        Object.keys(estudiante.materias || {}).forEach(materia => {
                            Object.keys(estudiante.materias[materia] || {}).forEach(periodo => {
                                if (estudiante.materias[materia][periodo].docente === docente.nombre) {
                                    estudiante.materias[materia][periodo].docente = nuevoNombre.trim();
                                }
                            });
                        });
                    });
                    
                    localStorage.setItem('docentes', JSON.stringify(docentes));
                    localStorage.setItem('calificaciones', JSON.stringify(calificaciones));
                    displayDocentes();
                    alert('Docente actualizado exitosamente.');
                }
            } catch (error) {
                console.error('Error editando docente:', error);
                alert('Error al editar el docente. Intenta nuevamente.');
            }
        }

        function editarEstudiante(id) {
            try {
                const estudiante = estudiantes.find(e => e.id === id);
                if (!estudiante) {
                    alert('Estudiante no encontrado.');
                    return;
                }
                
                const nuevoNombre = prompt('Nuevo nombre:', estudiante.nombre);
                if (nuevoNombre && nuevoNombre.trim()) {
                    estudiante.nombre = nuevoNombre.trim();
                    
                    // Update in calificaciones if exists
                    if (calificaciones[id]) {
                        calificaciones[id].nombre = nuevoNombre.trim();
                        localStorage.setItem('calificaciones', JSON.stringify(calificaciones));
                    }
                    
                    localStorage.setItem('estudiantes', JSON.stringify(estudiantes));
                    displayEstudiantes();
                    alert('Estudiante actualizado exitosamente.');
                }
            } catch (error) {
                console.error('Error editando estudiante:', error);
                alert('Error al editar el estudiante. Intenta nuevamente.');
            }
        }

        function agregarEvento() {
            const fecha = document.getElementById('nuevaFecha').value;
            const evento = document.getElementById('nuevoEvento').value.trim();
            const tipo = document.getElementById('tipoEvento').value;
            const descripcion = document.getElementById('descripcionEvento').value.trim();
            
            if (!fecha || !evento || !tipo) {
                alert('Por favor completa todos los campos obligatorios.');
                return;
            }
            
            eventos.push({ 
                fecha, 
                evento, 
                tipo, 
                descripcion: descripcion || evento 
            });
            localStorage.setItem('eventos', JSON.stringify(eventos));
            
            // Clear form
            document.getElementById('nuevaFecha').value = '';
            document.getElementById('nuevoEvento').value = '';
            document.getElementById('tipoEvento').value = 'academico';
            document.getElementById('descripcionEvento').value = '';
            
            displayEventos();
            updateCalendar();
            alert('¬°Evento agregado exitosamente!');
        }

        function displayEventos() {
            const lista = document.getElementById('listaEventos');
            lista.innerHTML = '';
            
            eventos.sort((a, b) => new Date(a.fecha) - new Date(b.fecha));
            
            eventos.forEach((evento, index) => {
                const div = document.createElement('div');
                div.className = 'flex justify-between items-center p-3 bg-gray-50 rounded border';
                
                const tipoColors = {
                    'academico': 'text-blue-600',
                    'reunion': 'text-green-600',
                    'festivo': 'text-red-600',
                    'evaluacion': 'text-yellow-600',
                    'actividad': 'text-purple-600'
                };
                
                const fecha = new Date(evento.fecha).toLocaleDateString('es-ES', {
                    day: 'numeric',
                    month: 'long',
                    year: 'numeric'
                });
                
                div.innerHTML = `
                    <div>
                        <p class="font-semibold">${evento.evento}</p>
                        <p class="text-sm text-gray-600">${fecha}</p>
                        <p class="text-sm ${tipoColors[evento.tipo] || 'text-gray-600'}">${evento.tipo.charAt(0).toUpperCase() + evento.tipo.slice(1)}</p>
                    </div>
                    <button onclick="eliminarEvento(${index})" class="text-red-500 hover:text-red-700">
                        <i class="fas fa-trash"></i>
                    </button>
                `;
                lista.appendChild(div);
            });
        }

        function eliminarEvento(index) {
            if (confirm('¬øEst√°s seguro de eliminar este evento?')) {
                eventos.splice(index, 1);
                localStorage.setItem('eventos', JSON.stringify(eventos));
                displayEventos();
                updateCalendar();
                alert('Evento eliminado exitosamente.');
            }
        }

        function loadReportesAdmin() {
            // General statistics
            const totalDocentes = docentes.filter(d => d.activo).length;
            const totalEstudiantes = estudiantes.filter(e => e.activo).length;
            const totalCalificaciones = Object.keys(calificaciones).length;
            
            document.getElementById('estadisticasGenerales').innerHTML = `
                <div class="space-y-3">
                    <div class="flex justify-between">
                        <span>Docentes Activos:</span>
                        <span class="font-semibold">${totalDocentes}</span>
                    </div>
                    <div class="flex justify-between">
                        <span>Estudiantes Activos:</span>
                        <span class="font-semibold">${totalEstudiantes}</span>
                    </div>
                    <div class="flex justify-between">
                        <span>Estudiantes con Notas:</span>
                        <span class="font-semibold">${totalCalificaciones}</span>
                    </div>
                    <div class="flex justify-between">
                        <span>Eventos Programados:</span>
                        <span class="font-semibold">${eventos.length}</span>
                    </div>
                </div>
            `;
            
            // Academic performance
            let totalNotas = 0;
            let sumaNotas = 0;
            let aprobados = 0;
            
            Object.values(calificaciones).forEach(estudiante => {
                Object.values(estudiante.materias).forEach(materia => {
                    Object.values(materia).forEach(periodo => {
                        totalNotas++;
                        sumaNotas += periodo.nota;
                        if (periodo.nota >= 3.0) aprobados++;
                    });
                });
            });
            
            const promedioGeneral = totalNotas > 0 ? (sumaNotas / totalNotas).toFixed(2) : 0;
            const porcentajeAprobacion = totalNotas > 0 ? ((aprobados / totalNotas) * 100).toFixed(1) : 0;
            
            document.getElementById('rendimientoAcademico').innerHTML = `
                <div class="space-y-3">
                    <div class="flex justify-between">
                        <span>Promedio General:</span>
                        <span class="font-semibold">${promedioGeneral}</span>
                    </div>
                    <div class="flex justify-between">
                        <span>Total Calificaciones:</span>
                        <span class="font-semibold">${totalNotas}</span>
                    </div>
                    <div class="flex justify-between">
                        <span>% Aprobaci√≥n:</span>
                        <span class="font-semibold">${porcentajeAprobacion}%</span>
                    </div>
                </div>
            `;
            
            // Attendance report (simulated)
            document.getElementById('reporteAsistencia').innerHTML = `
                <div class="space-y-3">
                    <div class="flex justify-between">
                        <span>Asistencia Promedio:</span>
                        <span class="font-semibold">94.5%</span>
                    </div>
                    <div class="flex justify-between">
                        <span>D√≠as Lectivos:</span>
                        <span class="font-semibold">180</span>
                    </div>
                    <div class="flex justify-between">
                        <span>D√≠as Transcurridos:</span>
                        <span class="font-semibold">45</span>
                    </div>
                </div>
            `;
        }

        function guardarConfiguracion() {
            const config = {
                nombreColegio: document.getElementById('nombreColegio').value,
                direccionColegio: document.getElementById('direccionColegio').value,
                telefonoColegio: document.getElementById('telefonoColegio').value,
                emailColegio: document.getElementById('emailColegio').value,
                anoEscolar: document.getElementById('anoEscolar').value,
                periodoActual: document.getElementById('periodoActual').value
            };
            
            localStorage.setItem('configuracion', JSON.stringify(config));
            alert('¬°Configuraci√≥n guardada exitosamente!');
        }

        function updateCalendar() {
            const calendar = document.getElementById('calendar');
            calendar.innerHTML = '';
            
            eventos.sort((a, b) => new Date(a.fecha) - new Date(b.fecha));
            
            const tipoColors = {
                'academico': 'bg-blue-50',
                'reunion': 'bg-green-50',
                'festivo': 'bg-red-50',
                'evaluacion': 'bg-yellow-50',
                'actividad': 'bg-purple-50'
            };
            
            eventos.slice(0, 5).forEach(evento => {
                const div = document.createElement('div');
                div.className = `mb-3 p-3 rounded ${tipoColors[evento.tipo] || 'bg-gray-50'}`;
                const fecha = new Date(evento.fecha).toLocaleDateString('es-ES', {
                    day: 'numeric',
                    month: 'long'
                });
                div.innerHTML = `<strong>${fecha}:</strong> ${evento.evento}`;
                calendar.appendChild(div);
            });
            
            if (eventos.length > 5) {
                const moreDiv = document.createElement('div');
                moreDiv.className = 'text-center text-sm text-gray-500 mt-2';
                moreDiv.innerHTML = `<i class="fas fa-ellipsis-h"></i> y ${eventos.length - 5} eventos m√°s`;
                calendar.appendChild(moreDiv);
            }
        }

        // Auto-save function to prevent data loss
        function autoSaveData() {
            try {
                localStorage.setItem('docentes', JSON.stringify(docentes));
                localStorage.setItem('estudiantes', JSON.stringify(estudiantes));
                localStorage.setItem('calificaciones', JSON.stringify(calificaciones));
                localStorage.setItem('comentarios', JSON.stringify(comentarios));
                localStorage.setItem('eventos', JSON.stringify(eventos));
                console.log('Datos guardados autom√°ticamente');
            } catch (error) {
                console.error('Error en guardado autom√°tico:', error);
            }
        }

        // Auto-save every 30 seconds
        setInterval(autoSaveData, 30000);

        // Save data before page unload
        window.addEventListener('beforeunload', function() {
            autoSaveData();
        });

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            try {
                displayComments();
                updateCalendar();
                
                // Set initial active navigation
                showSection('inicio');
                
                // Load saved configuration
                const config = JSON.parse(localStorage.getItem('configuracion') || '{}');
                if (config && Object.keys(config).length > 0) {
                    Object.keys(config).forEach(key => {
                        const element = document.getElementById(key);
                        if (element) {
                            element.value = config[key];
                        }
                    });
                }
                
                // Initialize default tab states
                const defaultDocenteTab = document.getElementById('tabCalificaciones');
                if (defaultDocenteTab) {
                    defaultDocenteTab.classList.add('tab-active');
                }
                
                // Initial auto-save
                autoSaveData();
                
                console.log('Sistema inicializado correctamente');
                console.log(`Docentes cargados: ${docentes.length}`);
                console.log(`Estudiantes cargados: ${estudiantes.length}`);
                console.log(`Calificaciones cargadas: ${Object.keys(calificaciones).length}`);
            } catch (error) {
                console.error('Error en la inicializaci√≥n:', error);
                alert('Error al inicializar el sistema. Algunos datos pueden no estar disponibles.');
            }
        });

        // Global error handling
        window.addEventListener('error', function(event) {
            console.error('Error global capturado:', event.error);
            // Don't show alert for every error, just log it
        });

        // Handle unhandled promise rejections
        window.addEventListener('unhandledrejection', function(event) {
            console.error('Promise rechazada:', event.reason);
            event.preventDefault();
        });

        // Close modals when clicking outside
        document.addEventListener('click', function(event) {
            const mapModal = document.getElementById('mapModal');
            if (event.target === mapModal) {
                closeMap();
            }
        });

        // Utility function to safely get element
        function safeGetElement(id) {
            const element = document.getElementById(id);
            if (!element) {
                console.warn(`Elemento no encontrado: ${id}`);
            }
            return element;
        }

        // Utility function to safely set value
        function safeSetValue(id, value) {
            const element = safeGetElement(id);
            if (element) {
                element.value = value;
                return true;
            }
            return false;
        }

        // Utility function to safely get value
        function safeGetValue(id) {
            const element = safeGetElement(id);
            return element ? element.value.trim() : '';
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97ae4789111cf78a',t:'MTc1NzE2NDk5MS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>

